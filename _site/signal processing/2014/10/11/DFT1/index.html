<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
    
  <!-- Enable responsiveness on mobile devices-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">-->
 

  <title>
    
      Discrete Fourier Transform For Freuency Analysis &middot; 
      pyVision
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/pyVision/public/css/poole.css">
  <link rel="stylesheet" href="/pyVision/public/css/syntax.css">
  <link rel="stylesheet" href="/pyVision/public/css/lanyon.css">
  <!--<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">-->
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/pyVisionpublic/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/pyVisionpublic/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({ 
                config: ["MMLorHTML.js"], 
                extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"], 
                jax: ["input/TeX"], 
                tex2jax: { 
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ], 
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ], 
                    processEscapes: false 
                }, 
                TeX: { 
                    TagSide: "right", 
                    TagIndent: ".8em", 
                    MultLineWidth: "85%", 
                    equationNumbers: { 
                       autoNumber: "AMS", 
                    }, 
                    unicode: { 
                       fonts: "STIXGeneral,'Arial Unicode MS'" 
                    } 
                }, 
                showProcessingMessages: false 
            }); 
</script>
<!--<script src="/pyVision/javascripts/gitdata.js"></script>-->
	<script type="text/javascript">
    	$(function() {
        $("#display-projects").getRepos("pi19404"); //Add your github username.
    	});
	</script>
<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<link href='http://alexgorbatchev.com/pub/sh/2.1.364/styles/shCore.css' rel='stylesheet' type='text/css'/> 
<link href='http://alexgorbatchev.com/pub/sh/2.1.364/styles/shThemeDefault.css' rel='stylesheet' type='text/css'/> 
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shCore.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushCpp.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushCSharp.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushCss.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushJava.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushJScript.js' type='text/javascript' /> </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushPhp.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushPython.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushRuby.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushSql.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushVb.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushXml.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushPerl.js' type='text/javascript' > </script>
<script language='javascript'> 
SyntaxHighlighter.config.bloggerMode = false;
SyntaxHighlighter.all();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38535188-2', 'auto');
  ga('send', 'pageview');

</script>
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">





  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/pyVision/">Home </a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/pyVision//about/">About</a>
        
      
    
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
    
      
    

    <!-- <a class="sidebar-nav-item" href="http://www.github.com/pi19404/pyVision/zipball/master">Download</a>
    <a class="sidebar-nav-item" href="http://www.github.com/pi19404/pyVision">GitHub project</a> -->
    <!-- <a class="sidebar-nav-item" ><g:plusone size="medium">Categories</g:plusone> </a> -->

    <div >
      <nav class="sidebar-nav-item">
        <g:plusone size="medium">Categories</g:plusone>
        
        
         
         <a class="sidebar-nav-item" href="/pyVision/category1/ai">
            AI
         </a>
        
         
         <a class="sidebar-nav-item" href="/pyVision/category1/embedded-firmware">
            Embedded Firmware
         </a>
        
         
         <a class="sidebar-nav-item" href="/pyVision/category1/linux">
            Linux
         </a>
        
         
         <a class="sidebar-nav-item" href="/pyVision/category1/raspberry-pi">
            Raspberry PI
         </a>
        
         
         <a class="sidebar-nav-item" href="/pyVision/category1/signal-processing">
            Signal Processing
         </a>
        
         
         <a class="sidebar-nav-item" href="/pyVision/category1/software">
            Software
         </a>
        
         
         <a class="sidebar-nav-item" href="/pyVision/category1/software-installation">
            Software Installation
         </a>
        
         
         <a class="sidebar-nav-item" href="/pyVision/category1/software-installation">
            Software installation
         </a>
        
      </nav>
    
    </div>
    <!-- <div>
      <ul>
        
        
        <li><a href="/pyVision//category/AI/index.html">AI</a></li>
        
        
        <li><a href="/pyVision//category/Signal+Processing/index.html">Signal Processing</a></li>
        
        
        <li><a href="/pyVision//category/Raspberry+PI/index.html">Raspberry PI</a></li>
        
        
        <li><a href="/pyVision//category/Linux/index.html">Linux</a></li>
        
        
        <li><a href="/pyVision//category/Software/index.html">Software</a></li>
        
        
        <li><a href="/pyVision//category/Embedded+Firmware/index.html">Embedded Firmware</a></li>
        
        
        <li><a href="/pyVision//category/Software+Installation/index.html">Software Installation</a></li>
        
        
        <li><a href="/pyVision//category/Software+installation/index.html">Software installation</a></li>
        
        </ul>
    
    </div> -->
<a class="sidebar-nav-item" >
<div class='g-person' data-href='https://plus.google.com/115840780257908006648' data-layout='landscape' data-rel='author' data-showcoverphoto='false' data-showtagline='false' data-theme='dark' data-width='100'></a>
</div>

<div class='widget-content'>
<script type="text/javascript" src="http://jj.revolvermaps.com/2/1.js?i=9bj6dpaloim&amp;s=220&amp;m=7&amp;v=true&amp;r=true&amp;b=ffffff&amp;n=false&amp;c=ff0000" async="async"></script>
</div>

<script type="text/javascript">
function cantload() {
img = document.getElementById("clustrMapsImg");
img.onerror = null;
img.src = "http://www2.clustrmaps.com/images/clustrmaps-back-soon.jpg";
document.getElementById("clustrMapsLink").href = "http://www2.clustrmaps.com";
}
img = document.getElementById("clustrMapsImg");
img.onerror = cantload;
</script>
<div class='widget-content'>
<div id="clustrmaps-widget"></div><script type="text/javascript">var _clustrmaps = {'url' : 'http://pi-virtualworld.blogspot.com', 'user' : 1165875, 'server' : '3', 'id' : 'clustrmaps-widget', 'version' : 1, 'date' : '2015-04-05', 'lang' : 'en', 'corners' : 'square' };(function (){ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'http://www3.clustrmaps.com/counter/map.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);})();</script><noscript><a href="http://www3.clustrmaps.com/user/ace11ca33"><img src="http://www3.clustrmaps.com/stats/maps-no_clusters/pi-virtualworld.blogspot.com-thumb.jpg" alt="Locations of visitors to this page" /></a></noscript>
</a>

<!-- Copyright (c)2009 Site Meter -->


</div>

<div class='widget-content'>
<script type="text/javascript" src="http://feedjit.com/serve/?vv=1022&amp;tft=3&amp;dd=0&amp;wid=f31e21a2d981f025&amp;pid=0&amp;proid=0&amp;bc=000000&amp;tc=F5F5F5&amp;brd1=454545&amp;lnk=C95050&amp;hc=FFFFFF&amp;hfc=5C5A5A&amp;btn=8A0214&amp;ww=200&amp;went=10"></script><noscript><a href="http://feedjit.com/">Feedjit Live Blog Stats</a></noscript>
</div>
 
<!-- Site Meter -->
<script type="text/javascript" src="http://s30.sitemeter.com/js/counter.js?site=s30pi19404">
</script>
<noscript>
<a href="http://s30.sitemeter.com/stats.asp?site=s30pi19404" target="_top">
<img src="http://s30.sitemeter.com/meter.asp?site=s30pi19404" alt="Site Meter" border="0"/></a>
</noscript>   
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2022. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      
        <div class="container">
          <h1 class="header">
            <a href="/" title="Home">pyVision</a></br>
            <small>A Machine Learning and Signal Processing toolbox</small>
          </h1>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/pi19404/pyVision/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/pi19404/pyVision/tarball/master" id="download-tar-gz" class="button"><span>Download.tar.gz</span></a>
          <a href="https://github.com/pi19404/pyVision" id="view-on-github" class="button"><span>View on GitHub</span></a>
		
	   <hr>
          </section>
    
	</br>	</br>
      <div class="content">
        <article class="post">
  <h1 class="post-title">Discrete Fourier Transform For Freuency Analysis</h1>
  <span class="post-date">11 Oct 2014</span>
  <h3 id="introduction">Introduction</h3>

<p><strong>Fourier analysis</strong> is generally concerned with the analysis and synthesis of functions. The decomposition of signal into easy-to-analyze components and the reconstruction from such components.</p>

<p>In this article we will look at Fourier analysis of discrete time signals.</p>

<p>Discrete time signal are defined at only particular set of time instances and are represented as sequence of real numbers that have continuous range of values</p>

<h3 id="fourier-series-representation-of-signal">Fourier Series Representation of signal</h3>

<p>A discrete time complex exponential is periodic in nature</p>

<p>$ e^{j k\omega (n+N)} = e ^{j k \omega n} $
where  , $\omega=\frac{2\pi}{N}$</p>

<p>The set of all discrete time time complex exponential signals that are periodic with period N is given by
$\phi_{k}[n] =  e ^{j k \frac{2\pi}{N} n} , \forall k \in \mathcal{Z}$</p>

<p>\(\phi\_{k+rN}[n] = e ^{j (k+rN) \frac{2\pi}{N} n}  = e ^{j k \frac{2\pi}{N} n}  * e ^{j r N \frac{2\pi}{N} n}\)
\(\phi\_{k+rN}[n] = e ^{j k \frac{2\pi}{N} n} e ^{j r  2\pi n} =e ^{j k \frac{2\pi}{N} n}\)</p>

<p>When k is changed by integral multiples of N ,we get identical sequence.
Thus there are only N unique values of k for which we can define unique discrete time complex exponential sequence.</p>

\[\begin{align} x[n]=\sum\_{k} x[k] e^{j k \omega n} \end{align}\]

<p>$e^{j k \omega n} $ are only unique over N successive values of k,summation is only considered
over this range</p>

\[\begin{align} x[n]=\sum\_{k={N}} x[k] e^{j k \omega n} \end{align}\]

<p>$x[n]$ is  periodic with period N.</p>

<h3 id="discrete-time-fourier-series">Discrete time Fourier Series</h3>

<p>Let us consider a arbitrary periodic signal $x[n]$ with period N and that  $x[n]$ can be expressed in the form</p>

\[\begin{align} x[n]=\sum\_{k} X[k] \phi\_{k}[n] \end{align}\]

<p>Thus we need to find out if $x[n]$ can be expressed in the above form and if so the coefficients $x[k]$ for which this representation is valid.</p>

<p>The theoretical derivations for the same can be found in all signal processing references.The result are as follows</p>

<p>\(\begin{align} X[k] =\sum\_{n=0}^{N-1}x[n] e^{- j k \frac{2\pi}{ N} n } \end{align}\) and 
\(\begin{align} x[n] =\frac{1}{N}\sum\_{k=0}^{N-1}X[k]\,e^{j k \frac{2\pi}{ N} n } \end{align}\)</p>

<p>$X[k]$ are called as <strong>Fourier series coefficients</strong>.The coefficients are also referred to as spectral coefficients of signal $x[n]$.</p>

<p>The representation of signal $x[n]$ in terms of spectral  coefficients is called as the <strong>Fourier series representation</strong> of the signal</p>

<p>These coefficient specify the decomposition of signal $x[n]$ into sum of N harmonically related complex exponential .</p>

<p>Any periodic discrete time signal $x[n]$ can be represented using the Fourier series representation 
and Fourier series representation enable us to represent any periodic signal as weighted sum of complex exponential s.</p>

<p>Let us look at some examples to understand what information can Fourier series representation of a signal give us.</p>

<pre class="brush: python">
def FourierSeries(input,N=None):
    """ computes the fourier series coefficients of input signal
    
    Parameters
    -----------
    input : numpy array
            input discrete time signal
            
    Returns
    --------
    out : complex,list
          fourier series coefficients
    """
    
    N=len(input);

    w=2*cmath.pi/N;
    input=input[0:N];
    n=numpy.arange(0,N);    
    r=cexp(-1j*w*n);

    output = [complex(0)] * N    
    for k in range(N):        
        r=input*cexp(-1j*w*n*k)          
        output[k]=np.sum(r);
        
   
    return output;

</pre>

<p>Let us consider a sinusoidal signal with frequency $f_{s}=10Hz$,for a duration of 1sec
Lets sample this waveform at $F_{s}=150Hz$ and observe the Fourier series coefficients of the signal</p>

<p>we sample at 150Hz,In the frequency spectrum,just consider a single period of the cosine waveform,ie 
$F_{s}/f_{s}=15$ samples.The output can be seen in subplot 2</p>

<p>we take complete signal,and compute the Fourier series coefficients,output can be seen in subplot 3</p>

<p>Let us consider  magnitude plot of Fourier series</p>

<p><img src="/pyVision/images/blog/images/image2.png" alt="enter image description here" /></p>

<pre class="brush : python ">
def FourierSinusoids(F,w,Fs,synthesis=None):    
    """ the function generates a discrete time sinusoid,computes
	the Fourier series coefficients and plots the time and frequency
	data 
 
     Paraneters
     ----------
     F : numpy array
         sinuoidal frequency components
         
     w  : numpy array
          the weights associated with freuency components
         
     Fs : Integer
          sampling frequency
          
     synthesis : int
                 if 1 ,reconstructs signal and plots the original and reconstructed
                 signal
 
    """
    if synthesis==None:
        synthesis=0;
        
    Ts=1.0/Fs;   
    xs=numpy.arange(0,1,Ts) 
    
    signal=numpy.zeros(np.shape(xs));
    for i in range(len(F)):
        omega=2*np.pi*F[i];
        signal = signal+ w[i]*numpy.cos(omega*xs);
    #plot the time domain signal    
    subplot(2,1,1)
    plt.plot(range(0,len(signal)),signal)
    xlabel('Time')
    ylabel('Amplitude')
    title('time doman')
    #plt.ylim(-2, 2)
    
    #compute fourier series coefficients
    r1=FourierSeries(signal)
    a1=cabs(r1)
    
    if synthesis==0:
        #plot the freuency domain signal
        L=len(a1);
        fr=np.arange(0,L);
        subplot(2,1,2)
        plt.stem(fr,a1,'r') # plotting the spectrum
        xlabel('Freq (Hz)')
        ylabel('|Y(freq)|')
        title('complete signal')
        ticks=np.arange(0,L+1,25);
        plt.xticks(ticks,ticks);     
        show() 
        
    if synthesis==1:
        rsignal=IFourierSeries(r1);
        print np.allclose(rsignal, signal)    
        subplot(2,1,2) 
        plt.stem(xs,signal)
        xlabel('Time')
        ylabel('Amplitude')
        title('reconstructed signal')
        show() 


if __name__ == "__main__":     

    mode =0
    
    if mode==0:
        F=[10];
        F=np.array(F);
        w=numpy.ones(F.shape);
        #plot the time domain signal and fourier series component
        FourierSinusoids(F,w,150);
</pre>

<p>we can see that the frequency corresponding to 10Hz we can observe peak.The total number of Fourier
series coefficients are equal to the total number of input samples.</p>

<p>Now let us consider a combination of sinusoidal signals at freuency 10 and 15Hz.The signal is periodic with frequency which is LCM of 10 and 15 ie 5Hz.</p>

<p><img src="/pyVision/images/blog/images/image4.png" alt="enter image description here" /></p>

<pre class="brush : python ">
    if mode==1:
        F=[10,20];
        F=np.array(F);
        w=numpy.ones(F.shape);
        FourierSinusoids(F,w,150); 
</pre>
<p>Now lets keep on adding frequency components.The below signal is periodic with period of 1 sec</p>

<p><img src="/pyVision/images/blog/images/image5.png" alt="enter image description here" /></p>

<pre class="brush : python ">

    if mode==2:
        F=range(1,10);
        F=np.array(F);
        w=numpy.ones(F.shape);	    
        FourierSinusoids(F,w,150);    
</pre>

<h3 id="synthesis-of-signal">Synthesis of Signal</h3>
<p>In the earlier section we saw the process of decomposition of aperiodic signal into its frequency components.</p>

<p>we will now look at the <strong>synthesis of signal</strong> from its Fourier series coefficients.</p>

\[{x[n] =
\frac{1}{N}\sum\_{k=0}^{N-1}X[k]\,e^{j k \frac{2\pi}{ N} n }}\]

<p>Below is plot of the original and reconstructed signal and python code for the</p>

<p><img src="/pyVision/images/blog/images/image6.png" alt="enter image description here" /></p>

<pre class="brush : python ">
def IFourierSeries(input):
    """ function reconstructs the signal from fourier series coefficients
    
    Parameters
    ---------
    input : cmath list
            fourier series coefficients    
    
    Returns
    -----------
    out : numpy arrary
          reconstructed signal
    
    """
    N=len(input);
    w=2*cmath.pi/N;
    k=numpy.arange(0,N);    
    output = [complex(0)] * N   
    for n in range(N):  
        r=input*cexp(-1j*w*n*k);
        output[n]=np.mean(r);

    print output.__class__    
    return output;


    if mode==3:
        F=range(1,10);
        F=np.array(F);
        w=numpy.ones(F.shape);
        FourierSinusoids(F,w,150,1); 
</pre>

<h3 id="discrete--fourier-transform">Discrete  Fourier Transform</h3>

<p>Now arises the situation what do we do for a-periodic signals.After a lot of theorotical analysis
on Discrete time Fourier transform and sampling in the frequency domain,it turns out
we just assume periodic extension of aperiodic signal and compute Fourier series as above.</p>

<p>The Fourier series coefficients for a periodic signal are also periodic with same period N</p>

\[X[k+N]=X[k]\]

<p>If we consider a single period of N values of Fourier series coefficient ,we obtain a finite duration sequence
which is called Discrete Fourier Transform (DFT).</p>

<p>Thus by computing the DFT we obtain the Fourier series coefficients for single period.</p>

<p>It is upto us to choose a period of the signal.Let us consider a aperiodic impulse of length 150 and on-duty cycle of 5.</p>

<p>Let us consider N=150,450 and observe the results.
<img src="/pyVision/images/blog/images/image7.png" alt="enter image description here" /></p>

<p>At we increase the period of the signal we can see that resolution in the freuency domain increases.</p>

<p>As $N \rightarrow \infty$ ,the samples in the freuency domain will be placed closer and closer .
If samples in frequency domain are spaced infinitely closely,it can be considered a continuous signal.
This gives us Discrete Time Fourier Transform representation of the signal.</p>

<p><img src="/pyVision/images/blog/images/image8.png" alt="enter image description here" /></p>

<pre class="brush : python ">
def FourierRect(N):     
        """ the function generates rectangular aperiodic pulse and computer the DFT coefficients
        
        Parameters
        ----------
        N : period of aperiodic signal
             
        """
        x = np.zeros((1,N))
        x[:,0:30]=1;
        x=x.flatten();
    
        
        #compute the DFT coefficients
        r1=FourierSeries(x)
        #magnitude of DFT coefficients
        a1=cabs(r1)

        #plot the time domain signal
        subplot(2,1,1)
        plt.plot(range(0,len(x)),x)
        xlabel('Time')
        ylabel('Amplitude')
        title('time doman')
        plt.ylim(-2,2);
        
        #plot the DFT coefficients
        L=len(a1);
        fr=np.arange(0,L);
        subplot(2,1,2)
        plt.stem(fr,a1,'r') # plotting the spectrum
        xlabel('Freq (Hz)')
        ylabel('|Y(freq)|')
        title('complete signal')
        ticks=np.arange(0,L+1,25);
        plt.xticks(ticks,ticks);     
        show() 

    if mode==4:
       FourierRect(150);

    if mode==5:
       FourierRect(150*3);        
</pre>
<p>It samples in frequency domain are spaced infinitely closely,it can be considered a continuous signal.
This representation of is called as Fourier Transform.</p>

\[X(k) = \sum x[n] exp(-j\omega k n)\]

<p>distance between adjacent samples is $\omega$ .As $ w \rightarrow 0 $ samples are placed infinitely closely with each other .</p>

\[X(w) = \sum x[n] exp(-j\omega  n)\]

<p>Fourier transform is continuous in nature and cannot be used for numeral computation .</p>

<p><strong>Discrete Fourier transform</strong> is sampled version of Discrete Time Fourier transform of a  signal and in in a form that is suitable for numerical computation on a signal processing unit.</p>

<p>A fast Fourier transform (FFT) is an algorithm to compute the discrete Fourier transform (DFT) and its inverse.It is a efficient way to compute the DFT of a signal.</p>

<p>we will use the  python FFT routine can compare the performance with naive implementation</p>

<p>Using the inbuilt FFT routine :Elapsed time was 6.8903e-05 seconds</p>

<p>Using the naive code :Elapsed time was 0.0653119 seconds</p>

<p>we can see improvement of order of 1000</p>

<p>The naive algorithm has complexity of $o(N^2)$ and FFT algorithm as complexity of $O(N log N)$</p>

<pre class="brush : python ">
    if mode==6:
        Fs=150;
        F=range(1,10);
        F=np.array(F);        
        w=numpy.ones(F.shape);

        
        Ts=1.0/Fs;   
        xs=numpy.arange(0,1,Ts) 
    
        signal=numpy.zeros(np.shape(xs));
        for i in range(len(F)):
            omega=2*np.pi*F[i];
            signal = signal+ w[i]*numpy.cos(omega*xs);        
            
            
        start_time = time.time()
        FourierSeries(signal)
        end_time = time.time()
        print("Elapsed time naive algo  %g seconds" % (end_time - start_time)) 

        start_time = time.time()
        fft(signal)
        end_time = time.time()
        print("Elapsed time of fft algo  %g seconds" % (end_time - start_time)) 
</pre>

<h4 id="circular-convolution-and-dft">Circular Convolution and DFT</h4>

<h5 id="circular-shift-of-a-sequence">Circular Shift of a sequence</h5>
<p>Let $x[n]$ denote the finite length time domain sequence</p>

<p>Once we take DFT ,in time domain we are constructing the periodic extension of the signal
Thus a time shit of signal is actually implies circular shit of the signal.</p>

<p>\(x[n] \Leftrightarrow X[k]\)
\(x[(n-n\_{o})\_{N}]  \Leftrightarrow e^{-j k \omega n\_{o}} X[k]\)</p>

<p>One of the most basic application in signal processing is linear convolution.</p>

<p>It can be used to represents the output of discrete time LTI system,correlation and cross correlation,
filtering and host of other signal processing operations.</p>

<p>Linear Convolution in discrete time system is represented as</p>

\[y[n]=\sum\_{i} x[i] h[n-i]\]

<p>The signals $x[n]$ and $h[n]$ are finite duration discrete time signals .</p>

<p>Linear convolution of 2 sequences of length M,L  results in sequence of length M+L-1</p>

<p>An associated discrete time Fourier transform property</p>

\[Y\left(\Omega\right) = X\left(\Omega\right)H\left(\Omega\right)\]

<p>Let us consider 2 sequences,take their DFT,multiply them and then take the inverse
<strong><code class="language-plaintext highlighter-rouge">Circular convolution in time domain leads to multiplication of DFT coefficients in the frequency domain</code></strong></p>

<p>lets take the seuences <code class="language-plaintext highlighter-rouge">[1,1,1,1,1]</code> and <code class="language-plaintext highlighter-rouge">[1,2,3,4]</code></p>

<pre class="brush : python ">
The result of linear convolution is `[ 1  3  6 10 10  9  7  4 ]`
The result of inverse of product of DFT coefficients is `[ 10.  10.  10.  10.  10.]`
</pre>

<p>we take N point DFT of signals,N=max(M,L)</p>

<pre class="brush : python ">
...|1 1 1 1 1|1 1 1 1 1|1 1 1 1 1|....
...|1 2 3 4 0|1 2 3 4 0|1 2 3 4 0|....
Result 
...|10|10|10| ...
</pre>

<p>Taking the DFT leads to periodicity in time domain,now we perform convolution as usual.
the $h[n-n_{o}]$ will be circularly shifted</p>

<pre class="brush : python ">
...|1 1 1 1 1|1 1 1 1 1|1 1 1 1 1|....
...|0 1 2 3 4|0 1 2 3 4|0 1 2 3 4|....

Result 
...|10|10|10| ...
</pre>
<pre class="brush : python ">
...|1 1 1 1 1|1 1 1 1 1|1 1 1 1 1|....
...|4 0 1 2 3 |4 0 1 2 3|4 0 1 2 3|....

Result 
...|10|10|10| ...
</pre>

<p>After N shifts we are repeating the sequence
Thus we perform the convolution of N shifts equivalent to the period of sequence in time domain</p>

<pre class="brush : python ">
Circular convolution
[ 10.  10.  10.  10.  10.]
</pre>

<p>Circular shift  is consequence of periodicity introduced by the DFT  and results in circular convolution operation</p>

<p>We can consider this due to the time aliasing being introduced due to sampling in the frequency domain.
The sampling theorem states that to avoid aliasing in frequency domain the sampling rate must be greater than twice the maximum frequency of signal being sampled.</p>

<p>We had mentioned earlier that DFT is the sampled version of DTFT .The question arises that how do we increase the sampling rate to avoid time domain aliasing.</p>

<p>We saw that zero padding the sequence leads to samples of Fourier series are placed more closely together.Equivalent to saying increases the sampling rate of DTFT in frequency domain,</p>

<p>This gives us a intuition that if we zero pad the sequence,it will lead to increased sampling rate of the DTFT of the signal.</p>

<p>For the result of circular convolution to be equal to the linear convolution,we simply zero pad the sequences to length of M+L-1.</p>

<pre class="brush : python ">
...|1 1 1 1 1 0 0 0 0 |1 1 1 1 1 0 0 0 0 |
...|1 2 3 4 0 0 0 0 0 |1 2 3 4 0 0 0 0 0 |

result : 10

...|1 1 1 1 1 1 0 0 0 |1 1 1 1 1 0 0 0 0 |
...|0 1 2 3 4 0 0 0 0 |0 1 2 3 4 0 0 0 0 |

result : 10

...|1 1 1 1 1 1 0 0 0 |1 1 1 1 1 0 0 0 0 |
...|0 0 1 2 3 4 0 0 0 |0 0 1 2  3 4 0 0 0 |

result : 9
</pre>

<p>thus we can see that due to zero padding,the circular shifted components are zeros
and the result obtained is equivalent to linear convolution result.</p>

<p>The code for the above example is given below</p>

<pre class="brush : python ">
    if mode == 7:
        x=np.array([1,1,1,1,1]);
        h=np.array([1,2,3,4,0]);
        r=np.convolve(x,h)
        print 'Linear convolution'
        print r

		#take 5 point DFT of the sequence
        f1=fft(x,5);
        f2=fft(h,5);
        s=ifft(f1*f2);
        print 'Circular convolution'
        print abs(s)
		
		#take 9 point DFT of sequence
        f1=fft(x,9);
        f2=fft(h,9);
        s=ifft(f1*f2);
        print 'zero padded Circular convolution'
        print r
</pre>

<h3 id="code">Code</h3>
<p>The code for all the examples can be found at github repository
<a href="https://github.com/pi19404/pyVision/tree/master/pySignalProc/tutorial/fourierSeries.py">https://github.com/pi19404/pyVision/tree/master/pySignalProc/tutorial/fourierSeries.py</a></p>

<p>You can change the mode variable in the file from 1-7 to generate all the plots shown in the article</p>

<p>The file fourierSeries.py can also be downloaded from below link</p>

<ul>
  <li><a href="http://www.codeproject.com/KB/Articles/828166/pySignalProc.zip">Download Link</a></li>
</ul>


</article>
<div id="page-navigation"> 
        <div class="clear">&nbsp;</div> 
        <div class="left"> 
         
                <a href="/pyVision//ai/2014/10/03/test/" title="Previous Post: 
Multilayer Perceptron in Python">&laquo; Multilayer Perceptron in Python</a> 
         
        </div> 

        <div class="right"> 
         
                <a href="/pyVision//signal%20processing/2014/10/13/TDOA1/" title="next Post: 
Time Delay Estimation Techniques - Part 1">Time Delay Estimation Techniques - Part 1 &raquo; </a> 
         
        </div> 
        <div class="clear">&nbsp;</div> 
</div> 
<div id="disqus_thread"></div>
		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
			var disqus_shortname = 'pi19404'; // required: replace example with your forum shortname
    			var disqus_identifier = '/signal%20processing/2014/10/11/DFT1/';
    			var disqus_url = 'http://pyvision.github.com/signal%20processing/2014/10/11/DFT1/';       
 
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>





      </div>
    </div>

      
       <footer>
          pyVision is maintained by <a href="https://github.com/pi19404">pi19404</a><br>
        </footer>
    
    </div>
 <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = true;
        }, false);
      })(document);
    </script>
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'pyvision'; // required: replace example with your forum shortname
    var disqus_identifier = '/signal%20processing/2014/10/11/DFT1/';
    var disqus_url = 'http://pyvision.github.com/signal%20processing/2014/10/11/DFT1/';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>

  </body>
</html>
