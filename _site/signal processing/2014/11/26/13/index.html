<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
    
  <!-- Enable responsiveness on mobile devices-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">-->
 

  <title>
    
      Haar Wavelet Filter Bank &middot; 
      pyVision
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/pyVision/public/css/poole.css">
  <link rel="stylesheet" href="/pyVision/public/css/syntax.css">
  <link rel="stylesheet" href="/pyVision/public/css/lanyon.css">
  <!--<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">-->
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/pyVisionpublic/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/pyVisionpublic/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({ 
                config: ["MMLorHTML.js"], 
                extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"], 
                jax: ["input/TeX"], 
                tex2jax: { 
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ], 
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ], 
                    processEscapes: false 
                }, 
                TeX: { 
                    TagSide: "right", 
                    TagIndent: ".8em", 
                    MultLineWidth: "85%", 
                    equationNumbers: { 
                       autoNumber: "AMS", 
                    }, 
                    unicode: { 
                       fonts: "STIXGeneral,'Arial Unicode MS'" 
                    } 
                }, 
                showProcessingMessages: false 
            }); 
</script>
<!--<script src="/pyVision/javascripts/gitdata.js"></script>-->
	<script type="text/javascript">
    	$(function() {
        $("#display-projects").getRepos("pi19404"); //Add your github username.
    	});
	</script>
<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<link href='http://alexgorbatchev.com/pub/sh/2.1.364/styles/shCore.css' rel='stylesheet' type='text/css'/> 
<link href='http://alexgorbatchev.com/pub/sh/2.1.364/styles/shThemeDefault.css' rel='stylesheet' type='text/css'/> 
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shCore.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushCpp.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushCSharp.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushCss.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushJava.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushJScript.js' type='text/javascript' /> </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushPhp.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushPython.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushRuby.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushSql.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushVb.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushXml.js' type='text/javascript' > </script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.364/scripts/shBrushPerl.js' type='text/javascript' > </script>
<script language='javascript'> 
SyntaxHighlighter.config.bloggerMode = false;
SyntaxHighlighter.all();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38535188-2', 'auto');
  ga('send', 'pageview');

</script>
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">





  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/pyVision/">Home </a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/pyVision//about/">About</a>
        
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
    
      
    

    <!-- <a class="sidebar-nav-item" href="http://www.github.com/pi19404/pyVision/zipball/master">Download</a>
    <a class="sidebar-nav-item" href="http://www.github.com/pi19404/pyVision">GitHub project</a> -->
    <a class="sidebar-nav-item" ><g:plusone size="medium">Categories</g:plusone> </a>
    <div>
      <ul>
        
        
        <li><a href="/pyVision//category/Linux/index.html">Linux</a></li>
        
        
        <li><a href="/pyVision//category/Signal+Processing/index.html">Signal Processing</a></li>
        
        
        <li><a href="/pyVision//category/Raspberry+PI/index.html">Raspberry PI</a></li>
        
        
        <li><a href="/pyVision//category/Software/index.html">Software</a></li>
        
        
        <li><a href="/pyVision//category/Embedded+Firmware/index.html">Embedded Firmware</a></li>
        
        
        <li><a href="/pyVision//category/Software+Installation/index.html">Software Installation</a></li>
        
        
        <li><a href="/pyVision//category/Software+installation/index.html">Software installation</a></li>
        
        </ul>
    
    </div>
<a class="sidebar-nav-item" >
<div class='g-person' data-href='https://plus.google.com/115840780257908006648' data-layout='landscape' data-rel='author' data-showcoverphoto='false' data-showtagline='false' data-theme='dark' data-width='100'></a>
</div>

<div class='widget-content'>
<script type="text/javascript" src="http://jj.revolvermaps.com/2/1.js?i=9bj6dpaloim&amp;s=220&amp;m=7&amp;v=true&amp;r=true&amp;b=ffffff&amp;n=false&amp;c=ff0000" async="async"></script>
</div>

<script type="text/javascript">
function cantload() {
img = document.getElementById("clustrMapsImg");
img.onerror = null;
img.src = "http://www2.clustrmaps.com/images/clustrmaps-back-soon.jpg";
document.getElementById("clustrMapsLink").href = "http://www2.clustrmaps.com";
}
img = document.getElementById("clustrMapsImg");
img.onerror = cantload;
</script>
<div class='widget-content'>
<div id="clustrmaps-widget"></div><script type="text/javascript">var _clustrmaps = {'url' : 'http://pi-virtualworld.blogspot.com', 'user' : 1165875, 'server' : '3', 'id' : 'clustrmaps-widget', 'version' : 1, 'date' : '2015-04-05', 'lang' : 'en', 'corners' : 'square' };(function (){ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'http://www3.clustrmaps.com/counter/map.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);})();</script><noscript><a href="http://www3.clustrmaps.com/user/ace11ca33"><img src="http://www3.clustrmaps.com/stats/maps-no_clusters/pi-virtualworld.blogspot.com-thumb.jpg" alt="Locations of visitors to this page" /></a></noscript>
</a>

<!-- Copyright (c)2009 Site Meter -->


</div>

<div class='widget-content'>
<script type="text/javascript" src="http://feedjit.com/serve/?vv=1022&amp;tft=3&amp;dd=0&amp;wid=f31e21a2d981f025&amp;pid=0&amp;proid=0&amp;bc=000000&amp;tc=F5F5F5&amp;brd1=454545&amp;lnk=C95050&amp;hc=FFFFFF&amp;hfc=5C5A5A&amp;btn=8A0214&amp;ww=200&amp;went=10"></script><noscript><a href="http://feedjit.com/">Feedjit Live Blog Stats</a></noscript>
</div>
 
<!-- Site Meter -->
<script type="text/javascript" src="http://s30.sitemeter.com/js/counter.js?site=s30pi19404">
</script>
<noscript>
<a href="http://s30.sitemeter.com/stats.asp?site=s30pi19404" target="_top">
<img src="http://s30.sitemeter.com/meter.asp?site=s30pi19404" alt="Site Meter" border="0"/></a>
</noscript>   
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2022. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      
        <div class="container">
          <h1 class="header">
            <a href="/" title="Home">pyVision</a></br>
            <small>A Machine Learning and Signal Processing toolbox</small>
          </h1>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/pi19404/pyVision/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/pi19404/pyVision/tarball/master" id="download-tar-gz" class="button"><span>Download.tar.gz</span></a>
          <a href="https://github.com/pi19404/pyVision" id="view-on-github" class="button"><span>View on GitHub</span></a>
		
	   <hr>
          </section>
    
	</br>	</br>
      <div class="content">
        <article class="post">
  <h1 class="post-title">Haar Wavelet Filter Bank</h1>
  <span class="post-date">26 Nov 2014</span>
  <h3 id="introduction">Introduction</h3>
<p>In this article we will look at discrete time signal processing using wavelets,more specificially we will look at the concept of Haar Filterbank</p>

<p>In the previous article <a href="http://pi19404.github.io/pyVision/2014/11/20/12/">Haar Wavelets</a> we saw the basics of harr wavelet and how a continuous time/discrete time signal can be expressed as sum of projection onto sub-spaces defined by wavelet and scaling function.</p>

<h3 id="analysisdecomposition-filters">Analysis/Decomposition Filters</h3>

<p>We saw that if we assume that the sampled signal is a projection onto subspace $V_{0}$
then using Harr scaling and wavelet function we can express the signal in terms of its projection on the subspaces $V_{-1} $ and $ W_{0}$</p>

<p>The process of expressing the signal by projecting on to subspaces of lower resolution is called as wavelet decomposition.</p>

<p>At each decomposition stage we project signal in subspace $V_{m}$ to subspaces $V_{m-1}$ and $W_{m}$
which are defined by scaling and wavelet functions.</p>

<p>We can see that once a we consider a projection on $V_{m}$ subspace we are dealing with a discrete time sequence.Let sequence be represented by  $x[n]$</p>

<p>The projection of signal from $V_{m}$  to $V_{m-1}$ using haar scaling function can be</p>

<p>$\displaystyle y[n] = \frac{1}{\sqrt2}  x[2n] + x[2n+1]$</p>

<p>Let $y_{o}[n]= \frac{1}{\sqrt2}  x[n] + x[n+1]$</p>

<p>$\displaystyle _{l}[n] = y_{o}[2n]$</p>

<p>The projection operation can be obtained by performing following steps</p>

<ul>
  <li>Apply discrete time filter $h_{l}[n]$ to discrete time signal which represents the projection of signal onto $V_{m}$ subspace</li>
  <li>Downsample the signal by a factor of 2 to get the projection on $V_{m-1}$ subspace</li>
</ul>

<p>The projection of signal from  $V_{m}$ to $W_{m}$ subspace using haar wavelet function can be expressed as</p>

<p>$\displaystyle y[n] = \frac{1}{\sqrt2}  x[2n] - x[2n+1]$</p>

<p>Let $y_{o}[n]= \frac{1}{\sqrt2}  x[n] - x[n+1]$</p>

<p>$\displaystyle y_{h}[n] = y_{o}[2n]$</p>

<p>The projection operation can be obtained by performing following steps</p>

<ul>
  <li>Apply discrete time filter $h_{u}[n]$ to discrete time signal which represents the projection of signal onto $V_{m}$ subspace</li>
  <li>Downsample the signal by a factor of 2 to get the projection on $W_{m}$ subspace</li>
</ul>

<p>$\displaystyle h_{l}[n]= \frac{1}{\sqrt2} [ 1 , 1 ] $ or $h_{l}[z] = \frac{1}{\sqrt2}[ 1 + z^{-1}]$</p>

<p>$\displaystyle h_{u}[n]= \frac{1}{\sqrt2} [- 1 , 1 ] $ or $h_{u}[z] = \frac{1}{\sqrt2}[ 1- z^{-1}]$</p>

<p>$h_{l}[n]$ computes the average of neighborhood samples acting as a low pass filter.The filter that projects onto subspace $V_{m-1}$ is called as low pass decomposition filter or low pass analysis filter</p>

<p>$h_{h}[n]$ computes the difference between neighborhood samples acting as a high pass filter.The filter that projects onto subspace $W_{m}$ is called as high pass pass decomposition filter or high pass analysis filter</p>

<p>The projection operation can be represented graphically as</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w2.png" alt="enter image description here" /></p>

<h3 id="reconstructionsynthesis-filters">Reconstruction/Synthesis Filters</h3>

<p>Given projection on signal on $V_{m-1}$ and $W_{m}$,given</p>

<p>$\displaystyle y_{l}[n] = \frac{1}{\sqrt2}  x[2n] + x[2n+1]$</p>

<p>$\displaystyle y_{h}[n] = \frac{1}{\sqrt2}  x[2n] - x[2n+1]$</p>

<p>we can see that
$\displaystyle x_{1}[n]=x[2n] = \frac{1}{\sqrt2} [y_{l}[n] + y_{h}[n] ]$</p>

<p>$\displaystyle x_{1}[n]=x[2n+1] = \frac{1}{\sqrt2} [y_{l}[n] - y_{h}[n] ]$</p>

<p>To get $x[n]$ we need to place  samples of $x_{1}[n]$ are even integer location 
and $x_{2}[n] $ at  odd integer location of $x[n]$</p>

<p>As example if $x_{1}[n]={1,2,3,4} $ and $x_{2}[n]={5,6,7,8}$
the desired sequence is $x[n]={1,5,2,6,3,7,4,8}$</p>

<p>This can be accomplished by first upsampling both the signals 
This will create a sequence new sequences $x_{1}[n],x_{2}[n]$ with zeros at odd integer locations</p>

<p>${1, 0 ,2 ,0, 3 ,0 4, 0, }$ and ${5, 0 ,6 ,0, 7 ,0 8, 0, }$</p>

<p>no  we delay $x_{2}[n]$ ,this will lead to sequence  with zeros at even integer locations</p>

<p>$\displaystyle {0,5, 0 ,6 ,0, 7 ,0 ,8}$
$\displaystyle {1, 0 ,2 ,0, 3 ,0 ,4, 0, }$</p>

<p>and adding both these signals will give us desired $x[n]$</p>

<p>$\displaystyle {1,5,2,6,3,7,4,8}$</p>

<p>This can be graphically represented as
<img src="http://pi19404.github.io/pyVision/images/13/w4.png" alt="enter image description here" /></p>

<p>We can as well upsample the original signals and then perform addition and subtraction and get the same result.</p>

<p>The equivalent block diagram can be expressed as
<img src="http://pi19404.github.io/pyVision/images/13/wave6.png" alt="enter image description here" /></p>

<p>$\displaystyle x_{1}[n] = \frac{1}{\sqrt2} [y_{l}[\frac{n}{2}] + y_{h}[\frac{n}{2}] ]$</p>

<p>$\displaystyle x_{2}[n] = \frac{1}{\sqrt2} [y_{l}[\frac{n}{2}] - y_{h}[\frac{n}{2}] ]$</p>

<p>$\displaystyle x[n] = x_{1}[n] + x_{2}[n-1]$</p>

<p>The delay element can be shifted to the source</p>

<p>$\displaystyle x[n] = \frac{1}{\sqrt2} [y_{l}[\frac{n}{2}] + y_{h}[\frac{n}{2}] ]+ [y_{l}[\frac{n-1}{2}] - y_{h}[\frac{n-1}{2}] ]$</p>

<p>$\displaystyle x[n] = \frac{1}{\sqrt2} [y_{l}[\frac{n}{2}] + y_{l}[\frac{n-1}{2}] ]+ [y_{h}[\frac{n}{2}] - y_{h}[\frac{n-1}{2}] ]$</p>

<p>$\displaystyle x[n] =  y_{l}[\frac{n}{2}] * h_{r,l}[n]+y_{h}[\frac{n}{2}] *h_{r,h}[n]$</p>

<p>where 
$\displaystyle h_{r,l}[n]= \frac{1}{\sqrt2} [ \delta[n] + \delta[n-1] ]$ is called low pass reconstruction/synthesis filter</p>

<p>$\displaystyle h_{r,h}[n]= \frac{1}{\sqrt2} [ \delta[n] - \delta[n-1] ]$ is called high pass reconstruction/synthesis filter</p>

<p>$\displaystyle h_{r,l}[n]= \frac{1}{\sqrt2} [ 1, 1] $</p>

<p>$\displaystyle h_{r,l}[n]= \frac{1}{\sqrt2} [ 1, -1] $</p>

<p>Thus we can see that we can recover the decomposed signal using above synthesis process</p>

<h3 id="haar--filter-bank">Haar  Filter Bank</h3>

<p>The entire process can be graphically represented as</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w7.png" alt="enter image description here" /></p>

<p>Let us look at what the analysis and synthesis filters are doing</p>

<h3 id="analysis-of-decomposition-filter">Analysis of Decomposition filter</h3>

<p>The decomposition filter coefficients are given by</p>

<p>$\displaystyle h_{d,l}[n]= \frac{1}{\sqrt2} [ 1 , 1 ] $ or $h_{l}[z] = \frac{1}{\sqrt2}[ 1 + z^{-1}]$</p>

<p>$\displaystyle h_{d,u}[n]= \frac{1}{\sqrt2} [- 1 , 1 ] $ or $h_{u}[z] = \frac{1}{\sqrt2}[ 1- z^{-1}]$</p>

<p>The Haar decomposition process can be graphically represented as</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w8.png" alt="enter image description here" /></p>

<p>$\displaystyle H_{0}[z] = \frac{1}{\sqrt2} [ 1 + z^{-1} ] $</p>

<p>$\displaystyle H_{1}[z] = \frac{1}{\sqrt2} [ 1 - z^{-1} ] $</p>

<p>Let us look at the frequency response of these filter
$\displaystyle H_{0}(w) = \frac{1}{\sqrt2} [ 1 + e^{-j\omega} ] $</p>

<p>$\displaystyle H_{0}(w) = \sqrt{2}e^{-j\frac{\omega}{2}} cos(\frac{\omega}{2}) $</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w9.png" alt="enter image description here" /></p>

<p>The phase response of the filter is $-\frac{\omega}{2}$ .The filter has linear phase
response.</p>

<p>We can see from magnitude response that filter has high gain near 0 frequencies while gain falls
to 0 at frequencies near $\omega= \pi$ .This acts like a crude low pass filter</p>

<p>Let us look at the frequency response of these filter
$\displaystyle H_{1}(w) = \frac{1}{\sqrt2} [ 1 - e^{-j\omega} ] $</p>

<p>$\displaystyle H_{1}(w) = \sqrt{2}e^{-j\frac{\omega}{2}+\frac{j\pi}{2}} sin(\frac{\omega}{2}) $</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w10.png" alt="enter image description here" /></p>

<p>We can see from magnitude response that filter has high gain near $\pi$ rads while gain falls
to 0 near frequencies of 0 .This acts like a crude high pass filter
and also has linear phase of $\frac{\pi}{2} - \frac{\omega}{2}$</p>

<p>we can see that</p>

<table>
  <tbody>
    <tr>
      <td>$\displaystyle</td>
      <td>H_{0}(w)</td>
      <td>^2 +</td>
      <td>H_{1}(w)</td>
      <td>^2=1$</td>
    </tr>
  </tbody>
</table>

<p>we can say that the filters are power complementary</p>

<p>$\displaystyle H_{0}(w) + H_{1}(w)=\sqrt{2}$</p>

<h3 id="analysis-of-reconstruction-filter">Analysis of Reconstruction filter</h3>

<p>The reconstruction filter coefficients are given by</p>

<p>$\displaystyle h_{r,l}[n]= \frac{1}{\sqrt2} [ 1 , 1 ] $ or $h_{l}[z] = \frac{1}{\sqrt2}[ 1 + z^{-1}]$</p>

<p>$\displaystyle  h_{r,u}[n]= \frac{1}{\sqrt2} [- 1 , 1 ] $ or $h_{u}[z] = \frac{1}{\sqrt2}[ 1- z^{-1}]$</p>

<p>The Haar reconstruction process can be graphically represented as</p>

<p>$\displaystyle  G_{0}[z] = \frac{1}{\sqrt2} [ 1 + z^{-1} ] $</p>

<p>$\displaystyle  G_{1}[z] = \frac{1}{\sqrt2} [ 1 - z^{-1} ] $</p>

<p>The synthesis filters have identical frequency reponse as corresponding analysis filters .
$G_{0}[z] $ represents a crude low pass filter while $G_{1}[z]$ represents a crude high pass filter</p>

<h3 id="realizable-two-band-filter-bank">Realizable two band filter bank</h3>

<p>One question to ask is that if we had used ideal filters would the decomposition and reconstruction still be possible.Instead of using crude filter banks why not use ideal filter banks</p>

<p>We have seen in the article <a href="http://pi19404.github.io/pyVision/page2/2014/10/11/DFT1/">“Discrete Time Fourier Transform for Frequency Analysis”</a>
that ideal low pass filter has the infinite impulse response,they are infinitely non causal hence cannot be realized in practice</p>

<p>The filters $H_{0}[z],G_{0}[z]$ aspire to be ideal low pass filter with cutoff frequencies of $\frac{\pi}{2}$</p>

<p>The filters $H_{1}[z],G_{1}[z]$ aspire to be ideal high pass filter with cutoff frequencies of $\frac{\pi}{2}$</p>

<p>They cannot however be ideal filters to be practically realizable ,hence we would want them to be as close to the ideal frequency response as possbile.Have a frequency response close to ideal frequency response and impulse response that is realizable.</p>

<p>The different wavelet families  essentially have the decomposition and reconstruction filters that are close to desired ideal frequency response.</p>

<p>Another way to look at the filters is thought the scaling and wavelet functions</p>

<p>$\phi(t)$ is basis of subspace $V_{m-1}$,$\phi(2t)$ defines basis of subspace $V_{m}$
we know that $V_{m-1} \subset V_{m}$,Thus basis of $V_{M-1}$ can be expressed in terms of basis 
of $V_{m}$</p>

<p>$\displaystyle  \phi(t) = [\phi(2t) + \phi(2t -\frac{T}{2})]$</p>

<p>In the earlier article on Haar wavelets we say that
$\displaystyle  \psi(t) = \phi(t)−\frac{1}{2}\phi(2t−\frac{T}{2}) $</p>

<p>$\displaystyle  \psi(t) = \frac{1}{\sqrt{2}}[\phi(2t) - \phi(2t +1)]$</p>

<p>This can be seen from the below figures
<img src="http://pi19404.github.io/pyVision/images/13/w11.png" alt="enter image description here" /></p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w12.png" alt="enter image description here" /></p>

<p>Thus the filter coefficients are nothing but the projection coefficients of basis function $\phi(t)$ in $V_{m}$ on subspace $V_{m-1}$ and $W_{m}$ whose basis are defined by set ${\phi(2t)}$</p>

<p>$\displaystyle  \phi(t) = \sum_{n} h[n] \phi(2t -n)$
$\displaystyle  \psi(t) = \sum_{n} g[n] \phi(2t -n)$</p>

<h3 id="frequency-analysis-of-wavelet-decomposition">Frequency analysis of wavelet decomposition</h3>

<p>The question we ask here is what does wavelet decomposition achieve</p>

<p>we again look at the decomposition filter
The decomposition filter coefficients are given by</p>

<p>$\displaystyle  h_{d,l}[n]= \frac{1}{\sqrt2} [ 1 , 1 ] $ or $h_{l}[z] = \frac{1}{\sqrt2}[ 1 + z^{-1}]$</p>

<p>$\displaystyle  h_{d,u}[n]= \frac{1}{\sqrt2} [- 1 , 1 ] $ or $h_{u}[z] = \frac{1}{\sqrt2}[ 1- z^{-1}]$</p>

<p>The Haar decomposition process can be graphically represented as</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w8.png" alt="enter image description here" /></p>

<p>$\displaystyle  H_{0}[z] = \frac{1}{\sqrt2} [ 1 + z^{-1} ] $</p>

<p>$\displaystyle  H_{1}[z] = \frac{1}{\sqrt2} [ 1 - z^{-1} ] $</p>

<p>The first step performed in the decomposition process is low pass and high pass filtering
Thus the we are essentially observing the low pass and high pass components idependently</p>

<p>Now we perform downsampling
we known that scaling in the time domain leads to expansion in the frequency domain</p>

<p>for example let us consider the signal</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w10.png" alt="enter image description here" /></p>

<p>we downsample the signal and observe its frequency response</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w11.png" alt="enter image description here" /></p>

<p>we can see that original signal had highest frequency content of 40Hz while the downsampled signal
has highest frequency content of 80Hz</p>

<p>Thus by dowsampling we have zoomed in on the frequency domain ,while zoomed out in the time domain
Thus we have increased the frequency resolution while reduced the time resolution of the signal</p>

<p>Thus by performing decomposition we are first dividing the frequency spectrum of signal into $0-\frac{pi}{2}$
and $\frac{\pi}{2}- \pi$ and zooming in each frequency interval by expanding the $0-\frac{pi}{2}$ interval  and $\frac{\pi}{2}- \pi$ interval to $0-pi $ respectively</p>

<p>At the next stage of decompostion,we only consider the output of the low pass filter,which is projection of signal onto $V_{m-1}$ subspace.That is essentially we are looking at the interval $0-\frac{pi}{2}$ of the original signal and again performing the same operation</p>

<p>They by splitting the interval into $0-\frac{pi}{4},\frac{pi}{4}-\frac{pi}{2}$ and so on.
Thus at each subspace projection $V_{m-1}$ we are essentially trying to zoom in the frequency domain of the signal while zooming out in the time domain .</p>

<p>Thus we are having a closer look at the frequency spectrum of the signal at each stage of the decomposition.However in standard decompostion process we only zoom into the low pass spectrum of signal. However the same can also be done for high pass spectrum ,ie we want to zoom into the high pass spectrum of the signal.</p>

<p>Another way to look at it is we are succesively dividing the frequency spectrum of the signal at each stage</p>

<ul>
  <li>
    <p>Stage 1  - $[0,\frac{\pi}{2}][\frac{\pi}{2},\pi]$</p>
  </li>
  <li>
    <p>Stage 2  - $[0,\frac{\pi}{4}][\frac{\pi}{4},\frac{\pi}{2}][\frac{\pi}{2},\pi]$</p>
  </li>
  <li>
    <p>Stage 3  - $[0,\frac{\pi}{8}][\frac{\pi}{8},\frac{\pi}{4}][\frac{\pi}{4},\frac{\pi}{2}][\frac{\pi}{2},\pi]$</p>
  </li>
</ul>

<p>At each stage we are looking at smaller region in frequency spectrum and conversely large region in the time domain</p>

<p>Lets look at the following signal and its decomposition</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w12.png" alt="enter image description here" /></p>

<p>Lets look at the frequency response</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w13.png" alt="enter image description here" /></p>

<p>We can see piece-wise constant approximation as well as frequency response</p>

<p>The first subplot is the output of the low pass filter or the approximation coefficient of last stage of decomposition and remaining plots are for detail coefficients at each stage of decomposition</p>

<p>we can see that since the filter being used is not ideal low/high pass in decomposition.
even though the signal has no high frequency components,the high pass decomposition filter
as produced a response.</p>

<p>We can also observe the zooming effect in the frequency response</p>

<p>Below is a plot for sinc squared signal</p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w14.png" alt="enter image description here" /></p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w15.png" alt="enter image description here" /></p>

<p>The same results can be observed for large stages of decomposition
<img src="http://pi19404.github.io/pyVision/images/13/w16.png" alt="enter image description here" /></p>

<p><img src="http://pi19404.github.io/pyVision/images/13/w17.png" alt="enter image description here" /></p>

<h3 id="code">Code</h3>
<p>The code for generating all the results and plots can be found the <a href="http://pi19404.github.io/pyVision/">pyVision</a> github repository</p>

<ul>
  <li>wavelet2.py</li>
</ul>

<h4 id="running-the-code">running the code</h4>
<ul>
  <li>The code uses pyWavelets python package.This needs to be installed before running the code.</li>
  <li>To run the code,download the entire pyVision repository.</li>
  <li>Go to the pySignalProc/tutorials directory and execute the wavelet2.py code</li>
</ul>


</article>
<div id="page-navigation"> 
        <div class="clear">&nbsp;</div> 
        <div class="left"> 
         
                <a href="/pyVision//raspberry%20pi/2014/11/21/13/" title="Previous Post: 
Remote Accessing Raspberry PI">&laquo; Remote Accessing Raspberry PI</a> 
         
        </div> 

        <div class="right"> 
         
                <a href="/pyVision//signal%20processing/2014/11/29/14/" title="next Post: 
Approximation of Piecewise Polynomial Using Wavelets">Approximation of Piecewise Polynomial Using Wavelets &raquo; </a> 
         
        </div> 
        <div class="clear">&nbsp;</div> 
</div> 
<div id="disqus_thread"></div>
		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
			var disqus_shortname = 'pi19404'; // required: replace example with your forum shortname
    			var disqus_identifier = '/signal%20processing/2014/11/26/13/';
    			var disqus_url = 'http://pyvision.github.com/signal%20processing/2014/11/26/13/';       
 
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>





      </div>
    </div>

      
       <footer>
          pyVision is maintained by <a href="https://github.com/pi19404">pi19404</a><br>
        </footer>
    
    </div>
 <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = true;
        }, false);
      })(document);
    </script>
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'pyvision'; // required: replace example with your forum shortname
    var disqus_identifier = '/signal%20processing/2014/11/26/13/';
    var disqus_url = 'http://pyvision.github.com/signal%20processing/2014/11/26/13/';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>

  </body>
</html>
